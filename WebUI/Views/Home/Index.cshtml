@model IndexViewModel

@{
    ViewData["Title"] = "Паркинг";
    ViewData["user"] = Model.User;
    ViewData["date"] = Model.Date.ToString("yyyy-MM-dd");
    ViewData["minDate"] = DateTime.Today.ToString("yyyy-MM-dd");
    ViewData["maxDate"] = DateTime.Today.AddMonths(1).ToString("yyyy-MM-dd");
}

@if (Model.Messages.Count > 0)
{
    for (int i = 0; i < Model.Messages.Count; i++)
    {
        <p class="text-@Model.Messages[i++]">@Model.Messages[i]</p>
    }
}
<div class="container">
    <div class="row">
        <form asp-controller="Home" asp-action="Index">
            <div class="col">
                <input asp-for="Date" class="form-control" type="date" min="@ViewData["minDate"]" max="@ViewData["maxDate"]" value="@ViewData["date"]">
            </div>
            <div class="col">
                <label class="text-center">Смяна</label>
                <select asp-for="Shift" asp-items="@Model.Shifts" class="custom-select"></select>
            </div>
            <div class="col">
                <button type="submit" class="btn btn-primary">Потърси!</button>
            </div>
        </form>
    </div>

    @for (int row = 0; row < 2; row++)
    {
        <div class="row">
            @for (int col = 0; col < 10; col++)
            {
                var reservation = Model.Reservations[row, col];


                <div class="col d-flex flex-wrap align-items-center parking-lot-@(row == 0 ? "first" : "second")-line">
                    @if (reservation != null)
                    {
                        @await Html.PartialAsync("_CarSpace", reservation)
                    }
                    else
                    {
                        @await Html.PartialAsync("_ReserveSpace", new ReservationViewModel { Space = (row * 10) + col + 1 })
                    }

                </div>
            }
        </div>
    }
    
    @if (User.Identity.IsAuthenticated)
    {
        @await Html.PartialAsync("_Profile", @Model.UserReservation)
    }
</div>